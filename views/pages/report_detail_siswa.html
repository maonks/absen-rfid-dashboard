<style>
/* tampil di layar saja */
.screen-only { display:block }
.print-only { display:none }

/* sembunyikan kolom di mobile */
.hide-mobile { display: table-cell; }

@media print {
  body * { visibility:hidden }
  #print-area, #print-area * { visibility:visible }
  #print-area { position:absolute; left:0; top:0; width:100% }
  .print-only { display:block }
  .screen-only { display:none }

  table { width:100%; border-collapse:collapse; font-size:11px }
  th,td { border:1px solid black; padding:4px }
  h2 { text-align:center; margin-bottom:8px }

  @page { size:A4 landscape; margin:10mm }
}

/* mobile */
@media (max-width:640px){
  table{font-size:10px}
  th,td{padding:2px!important}
  .hide-mobile{display:none}
}

.mobile-only {
  display: none;
}

@media (max-width: 640px) {
  .mobile-only {
    display: block;
  }
}
</style>

<h2 class="text-lg font-bold mb-3 screen-only">
  Report Detail Siswa
</h2>

<p class="mobile-only text-xs bg-yellow-100 text-yellow-800 border border-yellow-300 rounded px-2 py-1 mb-3 text-center">
  ‚ö†Ô∏è Data mobile dibatasi. Gunakan Desktop / Print / Export Excel untuk data lengkap.
</p>

<!-- ================= FILTER BAR ================= -->
<form method="GET"
      action="/report/detail-siswa"
      class="screen-only w-full mb-3 text-[11px]">

  <div class="flex flex-col sm:flex-row sm:items-center sm:justify-start gap-2">

    <div class="flex justify-center gap-2 sm:justify-start">

      <select name="kelas_id" class="border rounded px-2 py-1 bg-white">
        <option value="">Kelas</option>
        {{ range .Kelas }}
          <option value="{{ .ID }}" {{ if eq $.KelasID .ID }}selected{{ end }}>
            {{ .Nama }}
          </option>
        {{ end }}
      </select>

      <select name="jurusan_id" class="border rounded px-2 py-1 bg-white">
        <option value="">Jurusan</option>
        {{ range .Jurusan }}
          <option value="{{ .ID }}" {{ if eq $.JurusanID .ID }}selected{{ end }}>
            {{ .Nama }}
          </option>
        {{ end }}
      </select>

    </div>

    <div class="flex justify-center gap-2 sm:justify-start">

      <button type="submit"
              class="px-3 py-1 rounded bg-slate-700 text-white hover:bg-slate-800">
        üîç Generate
      </button>

      <button type="button"
              onclick="window.print()"
              class="px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700">
        üñ®Ô∏è Print
      </button>

      {{ if .Rows }}
      <button type="button"
        onclick="window.location.href='/report/detail-siswa/excel?kelas_id={{.KelasID}}&jurusan_id={{.JurusanID}}'"
        class="px-3 py-1 rounded bg-green-600 text-white hover:bg-green-700">
        üìä Excel
      </button>
      {{ end }}

    </div>

  </div>
</form>

<!-- ================= PRINT AREA ================= -->
<div id="print-area">

  <h2 class="text-lg font-bold mb-3 text-center print-only">
    Report Detail Siswa
    {{ if .KelasID }} Kelas {{ .KelasName }}{{ end }}
    {{ if .JurusanID }} - {{ .JurusanName }}{{ end }}
  </h2>

  <div class="overflow-x-auto">
    <table class="w-full border text-[11px]">

      <thead class="bg-slate-100 sticky-header">
        <tr>
          <th class="border px-2 py-1">No</th>
          <th class="border px-2 py-1">NIS</th>
          <th class="border px-2 py-1">Nama</th>

          <th class="border px-2 py-1 hide-mobile">JK</th>
          <th class="border px-2 py-1 hide-mobile">Tempat Lahir</th>
          <th class="border px-2 py-1 hide-mobile">Tanggal Lahir</th>
          <th class="border px-2 py-1 hide-mobile">Alamat</th>
          <th class="border px-2 py-1 hide-mobile">Wali</th>

          <th class="border px-2 py-1">No HP</th>

          <th class="border px-2 py-1 hide-mobile">Status</th>
          <th class="border px-2 py-1 hide-mobile">Kelas</th>
          <th class="border px-2 py-1 hide-mobile">Jurusan</th>
        </tr>
      </thead>

      <tbody>
      {{ range $i,$row := .Rows }}
      <tr class="border-b">
        <td class="border px-2 py-1 text-center">{{ add $i 1 }}</td>
        <td class="border px-2 py-1">{{ .NIS }}</td>
        <td class="border px-2 py-1 font-semibold">{{ .Nama }}</td>

        <td class="border px-2 py-1 hide-mobile">{{ .JenisKelamin }}</td>
        <td class="border px-2 py-1 hide-mobile">{{ .TempatLahir }}</td>
        <td class="border px-2 py-1 hide-mobile">{{ .TanggalLahir.Format "02-01-2006" }}</td>
        <td class="border px-2 py-1 hide-mobile">{{ .Alamat }}</td>
        <td class="border px-2 py-1 hide-mobile">{{ .NamaWali }}</td>

        <td class="border px-2 py-1">{{ .NoHP }}</td>

        <td class="border px-2 py-1 hide-mobile">{{ .Status }}</td>
        <td class="border px-2 py-1 hide-mobile">{{ .Kelas }}</td>
        <td class="border px-2 py-1 hide-mobile">{{ .Jurusan }}</td>
      </tr>
      {{ end }}
      </tbody>

    </table>
  </div>

</div>
